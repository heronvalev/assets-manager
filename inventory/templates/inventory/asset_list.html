{% extends "base.html" %}

{% block title %}Assets{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Assets</h2>
    <a href="{% url 'create_asset' %}" class="btn btn-primary">Add Asset</a>
</div>

<div class="mb-3">
    <form method="get" class="row g-3">
        <!-- Status checkboxes -->
        <div class="col-auto">
            <label>Status:</label><br>
            {% for status in status_options %}
                <input type="checkbox" name="status" value="{{ status }}"
                    {% if status in selected_statuses %}checked{% endif %}> {{ status }}<br>
            {% endfor %}
        </div>

        <!-- Category checkboxes -->
        <div class="col-auto">
            <label>Category:</label><br>
            {% for category in category_options %}
                <input type="checkbox" name="category" value="{{ category }}"
                    {% if category in selected_categories %}checked{% endif %}> {{ category }}<br>
            {% endfor %}
        </div>

        <!-- Brand checkboxes -->
        <div class="col-auto">
            <label>Brand:</label><br>
            {% for brand in brand_options %}
                <input type="checkbox" name="brand" value="{{ brand }}"
                    {% if brand in selected_brands %}checked{% endif %}> {{ brand }}<br>
            {% endfor %}
        </div>

        <!-- Location checkboxes -->
        <div class="col-auto">
            <label>Location:</label><br>
            {% for location in location_options %}
                <input type="checkbox" name="location" value="{{ location }}"
                    {% if location in selected_locations %}checked{% endif %}> {{ location }}<br>
            {% endfor %}
        </div>

        <!-- Date filters -->
        <div class="col-auto">
            <label>Purchase Date:</label><br>
            <input type="date" name="start_date" value="{{ start_date }}">
            to
            <input type="date" name="end_date" value="{{ end_date }}">
        </div>

        <!-- Submit button -->
        <div class="col-auto align-self-end">
            <button type="submit" class="btn btn-primary">Apply Filters</button>
        </div>
    </form>
</div>

<div class="table-responsive">
    <table class="table table-bordered table-striped align-middle">
        <thead class="table-header">
            <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Brand</th>
                <th>Model</th>
                <th>Serial Number</th>
                <th>Purchase Date</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Currently Assigned?</th>
                <th>Current Location</th>
            </tr>
        </thead>
        <tbody>
            {% for asset in assets %}
            <tr>
                <td>
                    <a href="{% url 'asset_details' asset.id %}">{{ asset.name }}</a>
                </td>

                <td>{{ asset.category }}</td>
                <td>{{ asset.brand }}</td>
                <td>{{ asset.model }}</td>
                <td>{{ asset.serial_number }}</td>
                <td>{{ asset.purchase_date }}</td>
                <td>{{ asset.status }}</td>
                <td>{{ asset.notes }}</td>
                <td>
                    {% if asset.is_assigned %}
                        {% if asset.get_current_user %}
                            <a href="{% url 'user_assignments' asset.get_current_user.id %}">
                                {{ asset.get_current_user.upn }}
                            </a>
                        {% else %}
                        Team/Room
                        {% endif %}
                    {% else %}
                        Unassigned
                    {% endif %}
                </td>

                <td>{{ asset.get_current_location }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="11">No assets found.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}

